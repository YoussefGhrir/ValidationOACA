
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>OACA autorisation</title>

    {% block stylesheets %}
        <link rel="stylesheet" href="{{ asset('design/css/status.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/msg.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/custom.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/icons.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/historique.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/date.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/carousel.css') }}">
        <link rel="stylesheet" href="{{ asset('design/css/search.css') }}">
        <!-- Flatpickr CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

        <!-- Favicon -->
        <link rel="icon" href="{{ asset('design/images/1200x630wa.ico') }}" type="image/x-icon">

        <!-- Stylesheets -->
        <link href="{{ asset('design/plugins/simplebar/css/simplebar.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/bootstrap.min.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/animate.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/icons.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/sidebar-menu.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/app-style.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/style.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/erreur.css') }}" rel="stylesheet"/>
        <link href="{{ asset('design/css/pdf.css') }}" rel="stylesheet"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    {% endblock %}
</head>
<body class="bg-theme bg-theme1" style="overflow: hidden; , font-weight: bold;">

<!-- Start Wrapper -->
<div id="wrapper">

    <!-- Start Sidebar -->
    <div id="sidebar-wrapper" data-simplebar="" data-simplebar-auto-hide="true">
        <div class="brand-logo">
            <a href="{{ path('app_home') }}">
                <img src="{{ asset('design/images/logo-icon.png') }}" class="logo-icon" alt="logo icon"
                     style="width: 100px; height: 100px; border-radius: 30%; margin-top: 10px;">
                <h5 class="logo-text" style="font-weight: bold; border-bottom: 2px solid #3498DB;">GESTION
                    VALIDATION</h5>
            </a>
        </div>
        <div style="margin-top: 125px;">
            {% if is_granted('ROLE_USER') %}
            <ul class="sidebar-menu do-nicescrol" style="overflow-y: auto; max-height: 500px;">
                <li class="sidebar-header underline-blue">PILOTES</li>
                <li><a href="{{ path('app_pilote_new') }}" target="_self"><i class="zmdi zmdi-format-list-bulleted"></i>
                        <span>Ajouter Pilote</span></a>
                </li>
                <li><a href="{{ path('app_pilote_atpl') }}" target="_self"><i class="zmdi zmdi-account-circle"></i>
                        <span>ATPL</span></a></li>
                <li><a href="{{ path('app_pilote_cpl') }}" target="_self"><i class="zmdi zmdi-account-circle"></i>
                        <span>CPL</span></a>
                </li>
                <li><a href="{{ path('app_pilote_double') }}" target="_self"><i class="zmdi zmdi-account-circle"></i>
                        <span>DOUBLE</span></a></li>
                <li class="sidebar-header underline-blue">GESTION ADMIN</li>
                <li><a href="{{ path('user_list') }}" target="_self"><i class="zmdi zmdi-grid"></i> <span>UTILISATEURS</span>
                        <small class="badge float-right badge-light">OACA</small></a>
                </li>
                <li class="sidebar-header underline-blue">AUTRES</li>

                <li><a href="{{ path('app_directeur_index') }}" target="_self"><i
                                class="zmdi zmdi-format-list-bulleted"></i>
                        <span>Directeur</span></a></li>
                <li><a href="{{ path('app_avion_index') }}" target="_self"><i
                                class="zmdi zmdi-format-list-bulleted"></i>
                        <span>Avion</span></a></li>
                <li><a href="{{ path('app_compagnie_index') }}" target="_self"><i
                                class="zmdi zmdi-format-list-bulleted"></i>
                        <span>Compagnie</span></a></li>

                <li><a href="{{ path('app_ministere_index') }}" target="_self"><i
                                class="zmdi zmdi-format-list-bulleted"></i>
                        <span>Ministére</span></a></li>
                <li><a href="{{ path('profile_show') }}" target="_self"><i class="zmdi zmdi-face"></i>
                        <span>Profil</span></a></li>
                {% endif %}
            </ul>
        </div>
    </div>
    <!-- End Sidebar -->

    <!-- Start Topbar -->
    <header class="topbar-nav">
        <nav class="navbar navbar-expand fixed-top">
            <!-- Left Side -->
            <ul class="navbar-nav mr-auto align-items-center">
                <!-- Menu Toggle -->
            </ul>

            <!-- Right Side -->
            <ul class="navbar-nav align-items-center right-nav-link">
                <li>
                    <button id="zoom-in" class="btn zoom-btn" style="background-color: #4CAF50; color: white;">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button id="zoom-out" class="btn zoom-btn" style="background-color: #FF6347; color: white;">
                        <i class="fas fa-search-minus"></i>
                    </button>
                </li>
                <!-- Connection Status -->
                <li class="nav-item">
                    {% if app.user %}
                        <a href="{{ path('app_logout') }}" class="nav-link">
                            <i class="zmdi zmdi-power"></i>
                            <span>Déconnexion</span>
                            <span class="status-indicator connected"></span>
                        </a>
                    {% else %}
                        <a href="{{ path('app_login') }}" class="nav-link">
                            <i class="zmdi zmdi-lock"></i>
                            <span>Connexion</span>
                            <span class="status-indicator disconnected"></span>
                        </a>
                    {% endif %}
                </li>
            </ul>
        </nav>

    </header>
    <!-- End Topbar -->

    <div class="clearfix"></div>
    <!-- Start Content Wrapper -->
    <div class="content-wrapper">
        <div class="container-fluid">
            <!-- Start Flash Messages Section -->
            {% for label, messages in app.flashes %}
                <div class="custom-flash-message alert alert-{{ label }} alert-dismissible fade show" role="alert">
                    {% for message in messages %}
                        <p>{{ message }}</p>
                    {% endfor %}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
            <!-- End Flash Messages Section -->
            <!-- Conditional Display of Moving Message -->
            {% if current_route() == 'app_home' %}
                <div class="moving-message">
                    <span>BIENVENUE AU GESTION DES VALIDATIONS DES PILOTES</span>
                </div>
            {% endif %}
            <br>
            <main>
                {% if app.request.get('_route') == 'app_home' %}
                    <div id="carouselExampleIndicators" class="carousel slide custom-carousel" data-bs-ride="carousel" data-bs-interval="5000">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
                        </div>
                        <div class="carousel-inner">
                            <!-- First Slide -->
                            <div class="carousel-item active">
                                <div class="carousel-image-container">
                                    <img src="{{ asset('design/images/img.png') }}" class="d-block w-100" alt="First Slide">
                                </div>
                            </div>
                            <!-- Second Slide -->
                            <div class="carousel-item">
                                <div class="carousel-image-container">
                                    <img src="{{ asset('design/images/img_1.png') }}" class="d-block w-100" alt="Second Slide">
                                </div>
                            </div>
                            <!-- Third Slide -->
                            <div class="carousel-item">
                                <div class="carousel-image-container">
                                    <img src="{{ asset('design/images/img_2.png') }}" class="d-block w-100" alt="Third Slide">
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </main>


            <div id="content-to-zoom">
                {% block body %}
                {% endblock %}
            </div>
        </div>
    </div>
    <!-- End Content Wrapper -->

    <!-- Start Back To Top Button -->
    <a href="javascript:void(0);" class="back-to-top"><i class="fa fa-angle-double-up"></i></a>
    <!-- End Back To Top Button -->

    <!-- Start Footer -->
    <footer class="footer">
        <div class="container">
            <div class="text-center copyright-text" style="font-weight: bold;">
                &copy; <span id="currentYear"></span> OACA. Tous droits réservés.
            </div>

            <script>
                document.getElementById('currentYear').textContent = new Date().getFullYear();
            </script>
        </div>
    </footer>
    <!-- End Footer -->


</div>
<!-- End Wrapper -->

{% block javascripts %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script>// Flash Message Handling: Automatically dismiss after 3 seconds
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const flashMessages = document.querySelectorAll('.custom-flash-message');
                flashMessages.forEach((message) => {
                    message.classList.remove('show');
                    setTimeout(() => {
                        message.remove();
                    }, 500); // Time for CSS transition
                });
            }, 3000); // Message disappears after 3 seconds (3000ms)
        });
    </script>
    <!-- jQuery - Chargé à partir de CDN pour une meilleure performance avec un fallback local -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="{{ asset('assets/js/jquery.min.js') }}"><\/script>')
    </script>

    <!-- Bootstrap JS - Chargé à partir de CDN avec fallback local -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script>
        if (typeof ($.fn.modal) === 'undefined') {
            document.write('<script src="{{ asset('assets/js/bootstrap.min.js') }}"><\/script>');
        }
    </script>

    <!-- Flatpickr Initialization -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            flatpickr('.datepicker', {
                dateFormat: 'Y-m-d',  // Format de la date compatible avec Symfony
                allowInput: true,     // Permettre la saisie manuelle via le clavier
                locale: 'fr'          // Localisation en français
            });
        });
    </script>

    <!-- Flash Message Handling -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const flashMessages = document.querySelectorAll('.flash-message');
                flashMessages.forEach((message) => {
                    message.classList.add('fade');
                    setTimeout(() => {
                        message.remove();
                    }, 200); // Time for CSS transition
                });
            }, 2000); // Time before hiding the message (2000ms = 2 seconds)
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let zoomLevel = 1;
            const zoomStep = 0.1;
            const maxZoom = 2;  // Zoom maximum (200%)
            const minZoom = 0.5; // Zoom minimum (50%)
            const contentToZoom = document.getElementById('content-to-zoom');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');

            // Fonction pour appliquer le zoom avec centrage
            function applyZoom() {
                contentToZoom.style.transform = `scale(${zoomLevel})`;
                contentToZoom.style.transformOrigin = 'center center'; // Zoomer depuis le centre
            }

            // Événement pour le bouton Zoom avant
            zoomInBtn.addEventListener('click', function () {
                if (zoomLevel < maxZoom) {
                    zoomLevel += zoomStep;
                    applyZoom();
                }
            });

            // Événement pour le bouton Zoom arrière
            zoomOutBtn.addEventListener('click', function () {
                if (zoomLevel > minZoom) {
                    zoomLevel -= zoomStep;
                    applyZoom();
                }
            });

            // Initialiser le zoom à 100%
            applyZoom();
        });
    </script>
    <script>document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.toggle-switch').forEach(function(toggle) {
                toggle.addEventListener('change', function() {
                    var statut = this.checked ? 1 : 0;  // 1 an (true) ou 2 ans (false)
                    var piloteId = this.getAttribute('data-id');

                    // Faire une requête POST pour sauvegarder le statut
                    fetch(`/pilote/update-statut/${piloteId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ statut: statut })
                    }).then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                console.log("Statut mis à jour avec succès");
                            } else {
                                console.error("Erreur lors de la mise à jour du statut");
                            }
                        });
                });
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
</body>
</html>